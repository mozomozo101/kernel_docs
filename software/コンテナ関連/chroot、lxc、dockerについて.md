https://www.creationline.com/lab/5339

# chroot
`/tmp/pseudo_root` にchrootすると、それを実行したプロセスと、その子孫プロセスは、`/tmp/pseudo_root` をrootとして扱う。
`sudo chroot /tmp/myroot` とすれば、/tmp/myroot が / になるということ。

* メリット
  * ホストとは独立した、独自のライブラリ（libcなど）を持てる
      * /usr/lib などは独自のものになる
  * chroot環境からは、ホストのrootfsにアクセスできない

* デメリット
  * chroot 環境に、システムの動作に必要な一連のファイルを全て揃える必要がある
    * /etc, /proc, /dev などなど
  * カーネル経由で、ホストのプロセスに干渉できる
    * `kill <ホスト上のPID>` で、ホスト上で動くプロセスをkillできる
  * リソースは、ホストと共有
  * 脱獄の危険あり
    * chrootを実行したプロセスは、root権限を持つ

# コンテナ
chrootではできなかった、プロセスやリソースの隔離を行うための技術。

## LXC
cgroup　や namespace　などのカーネル機能を使って、コンテナごとにプロセスやリソースを隔離する。
cgroup、namespaceはどちらもカーネルの機能。
これは、ざっくり言うと、プロセスを、UID,PID,マウント名などの単位でグループ分けして、各グループに対してリソース制限をかけるための機能。

* メリット
  * chrootよりも、隔離できる範囲が広い
    * プロセス、リソースなど
* デメリット
  * 移植性が悪い
    * lxc自体の設定は人それぞれで、他のホストにコンテナを持っていっても、同じように使えるとは限らない

## docker
既存のコンテナ技術を使いやすくしたもの。
cgroup　や namespace　を使ってるらしい。
* メリット
  * サイズが小さい
    * LXCはrootfsをまるっとコンテナ化するが、dockerはアプリケーション単位でコンテナ化する
  * コンテナへの変更を差分として管理できる
  * 移植性が高い
    * dockerで作ったコンテナは、他のどのdockerでも動く
